<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no"><title> Docker Registry HTTP API V2 规范 | arctanp</title><meta name="keywords" content="docker,后端"><meta name="author" content="Tanpinsary"><meta name="copyright" content="Tanpinsary"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#f7f9fe"><meta name="mobile-web-app-capable" content="yes"><meta name="apple-touch-fullscreen" content="yes"><meta name="apple-mobile-web-app-title" content=" Docker Registry HTTP API V2 规范"><meta name="application-name" content=" Docker Registry HTTP API V2 规范"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="#f7f9fe"><meta property="og:type" content="article"><meta property="og:title" content=" Docker Registry HTTP API V2 规范"><meta property="og:url" content="http://blog.arctanp.top/2025/09/21/Docker Registry HTTP API V2 规范/index.html"><meta property="og:site_name" content="arctanp"><meta property="og:description" content="整理一下 BYR2025 后端考核题 Docker It Yourself 需要的 Docker Registry API 规范文档内容，供项目编写使用。内容参考网站为 Docker Registry HTTP API V2 规范  须知：   此 API 中的所有端点均以版本号和存储库名称作为前缀"><meta property="og:locale" content="zh-CN"><meta property="og:image" content="https://pic.arctanp.top/PicGo/1742042046711.jpeg?_r_=d06eaa39-7233-2845-d544-02a9024b00df"><meta property="article:author" content="Tanpinsary"><meta property="article:tag"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://pic.arctanp.top/PicGo/1742042046711.jpeg?_r_=d06eaa39-7233-2845-d544-02a9024b00df"><meta name="description" content="整理一下 BYR2025 后端考核题 Docker It Yourself 需要的 Docker Registry API 规范文档内容，供项目编写使用。内容参考网站为 Docker Registry HTTP API V2 规范  须知：   此 API 中的所有端点均以版本号和存储库名称作为前缀"><link rel="shortcut icon" href="/favicon.ico"><link rel="canonical" href="http://blog.arctanp.top/2025/09/21/Docker%20Registry%20HTTP%20API%20V2%20%E8%A7%84%E8%8C%83/"><link rel="preconnect" href="//cdn.cbd.int"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><meta name="google-site-verification" content="xxx"/><meta name="baidu-site-verification" content="code-xxx"/><meta name="msvalidate.01" content="xxx"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.cbd.int/node-snackbar@0.1.16/dist/snackbar.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.cbd.int/@fancyapps/ui@5.0.28/dist/fancybox/fancybox.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://npm.elemecdn.com/anzhiyu-theme-static@1.0.0/swiper/swiper.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = {
  linkPageTop: undefined,
  peoplecanvas: {"enable":true,"img":"https://upload-bbs.miyoushe.com/upload/2024/07/27/125766904/ba62475f396df9de3316a08ed9e65d86_5680958632268053399..png"},
  postHeadAiDescription: {"enable":true,"gptName":"tanp","mode":"local","switchBtn":true,"btnLink":"https://afdian.net/item/886a79d4db6711eda42a52540025c377","randomNum":3,"basicWordCount":1000,"key":"xxxx","Referer":"https://xx.xx/"},
  diytitle: undefined,
  LA51: undefined,
  greetingBox: {"enable":true,"default":"喜欢视奸？","list":[{"greeting":"夜","startTime":0,"endTime":4},{"greeting":"4点了 该坠机了","startTime":4,"endTime":4},{"greeting":"tanp大概率在睡觉","startTime":5,"endTime":10},{"greeting":"呜噜呜噜摸了","startTime":10,"endTime":18},{"greeting":"该饭了","startTime":18,"endTime":19},{"greeting":"夜","startTime":19,"endTime":24}]},
  twikooEnvId: '',
  commentBarrageConfig:undefined,
  music_page_default: "nav_music",
  root: '/',
  preloader: {"source":3},
  friends_vue_info: undefined,
  navMusic: false,
  mainTone: undefined,
  authorStatus: {"skills":["最大的技能就是还活着"]},
  algolia: undefined,
  localSearch: undefined,
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"简","rightMenuMsgToTraditionalChinese":"转为繁体","rightMenuMsgToSimplifiedChinese":"转为简体"},
  noticeOutdate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":330},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    simplehomepage: true,
    post: false
  },
  runtime: '天',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: {"copy":true,"copyrightEbable":false,"limitCount":50,"languages":{"author":"作者: Tanpinsary","link":"链接: ","source":"来源: arctanp","info":"著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。","copySuccess":"复制成功，复制和转载请标注本文地址"}},
  lightbox: 'fancybox',
  Snackbar: {"chs_to_cht":"你已切换为繁体","cht_to_chs":"你已切换为简体","day_to_night":"你已切换为深色模式","night_to_day":"你已切换为浅色模式","bgLight":"#425AEF","bgDark":"#1f1f1f","position":"top-center"},
  source: {
    justifiedGallery: {
      js: 'https://cdn.cbd.int/flickr-justified-gallery@2.1.2/dist/fjGallery.min.js',
      css: 'https://cdn.cbd.int/flickr-justified-gallery@2.1.2/dist/fjGallery.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: true,
  isAnchor: true,
  shortcutKey: undefined,
  autoDarkmode: true
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  configTitle: 'arctanp',
  title: ' Docker Registry HTTP API V2 规范',
  postAI: '',
  pageFillDescription: '须知：, Docker Registry 构成, Pulling Images, Pushing Images, Deleting Images, API, API 列表和响应码（省流版）, Manifest, Get image manifest, Put image manifest, Check if manifest exists, Delete image manifest, Blob, Initiate blob upload or attempt cross-repository blob mount, Check existence of blob, Retrieve blob, Get blob upload status, Complete blob upload, Upload blob chunk, Cancel blob upload, API 详细参数相应格式, Manifest, Blob整理一下后端考核题需要的规范文档内容供项目编写使用内容参考网站为规范须知此中的所有端点均以版本号和存储库名称作为前缀例如我想和库进行交互则使用不做要求构成一共要维护三类实体的信息和是描述镜像的文档包含其配置各每层的以及平台类型和注释等元数据是从文件中引用的二进制对象包含和若干包是一个所对应所有的元数据列表获取后通过对应的值获取再根据的内容下载所有拉取镜像也就是检索并下载对应中的各层以下为步骤获取仓库鉴权本次项目不需要实现获取若前两步获取的是一个多架构的则需要解析并根据架构定位具体根据获取下载前确认是否存在客户端应该向每一层发送请求根据前几步获取的从中获取每一层的客户端应发送请求下面是官网给的的脚本示例示例拉取平台上镜像推送镜像与拉取相对应的提交镜像的各层例如和然后上传引用这些的以下为步骤获取仓库鉴权本次项目不需要实现使用请求确保对于每一个对应的都存在若不存在则使用单体请求上传使用初始化上传使用完成上传也可以使用分块上传的方式上传一个大型对象或者恢复终端上传具体操作是使用请求发送每一个数据块最后用请求完成上传使用请求上传以关联和下面是官网给的的脚本示例示例推送了一个空的和到上该样例推送了一个不包含任何的镜像如果要推送一个完整的有内容的镜像需要对每个重复次的推送并且把每个的保存在的内删除镜像包括通过删除想要删除首先得获取然后再使用请求删除并非所有的都可以删除只有没有标记的或者没有被其他或者引用的才能被删除我猜是避免空指针问题如果删除的是被引用的返回以下为步骤获取仓库鉴权本项目不需要实现使用获取从清单响应中获取标头该摘要可唯一标识该清单使用请求根据删除下面是官网给的的脚本示例示例删除了上的不过似乎没有检查是否该被其他引用列表和响应码省流版详细参数相应格式由和获取其中可以是也可以是获取一个标准的格式上传指定或者的到的为通过或验证是否存在仅返回头信息无正文适用于检查特定镜像版本是否存在在下载或删除前确定清单的摘要或大小此接口需要具有拉取权限的身份验证通过摘要从存储库中删除映像清单仅可删除未标记或未被引用的清单若清单仍被标签或其他映像引用注册表将返回禁止访问状态码为存储库中的或启动上传会话这是上传的第一步该操作返回一个位置用户可通过分块上传或整体上传方式将块对象上传至该位置客户端也可尝试挂载其他存储库中的需具备读取权限通过添加和查询参数实现若挂载成功注册表将返回状态码将被复用而无需重新上传若挂载失败上传将按常规流程进行并返回状态码必须使用具有目标存储库推送权限的凭据进行身份验证检查是否已经存在检索正在进行的上传的当前状态此功能适用于恢复中断的上传确定当前已接收的字节数在分块上传中从正确偏移量重试响应包含标头指示当前接收的字节范围和用于识别会话的此请求必须包含摘要查询参数并可选地包含最后一个数据块当存储注册表收到此请求时它会验证摘要并存储此端点支持整体上传在此请求中上传整个或完成分块上传最后一个数据块加摘要将块状数据分段上传至活跃的上传会话此方法适用于分段上传尤其适用于大型块状数据或恢复中断上传的情境客户端通过请求发送二进制数据可选添加头部每当分块被接受后注册表将返回响应包含当前存储的字节范围上传会话标识符继续上传或通过完成上传的取消正在进行的上传会话此操作将丢弃已上传的所有数据并使上传会话失效适用场景上传失败或中途中止时客户端需要清理未使用的上传会话时取消后将失效必须重新发出请求才能重启上传',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2025-10-01 19:49:09',
  postMainColor: '',
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
      win.saveToLocal = {
        set: (key, value, ttl) => {
          if (ttl === 0) return
          const now = Date.now()
          const expiry = now + ttl * 86400000
          const item = {
            value,
            expiry
          }
          localStorage.setItem(key, JSON.stringify(item))
        },
      
        get: key => {
          const itemStr = localStorage.getItem(key)
      
          if (!itemStr) {
            return undefined
          }
          const item = JSON.parse(itemStr)
          const now = Date.now()
      
          if (now > item.expiry) {
            localStorage.removeItem(key)
            return undefined
          }
          return item.value
        }
      }
    
      win.getScript = (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        script.onerror = reject
        script.onload = script.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          script.onload = script.onreadystatechange = null
          resolve()
        }

        Object.keys(attr).forEach(key => {
          script.setAttribute(key, attr[key])
        })

        document.head.appendChild(script)
      })
    
      win.getCSS = (url, id = false) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onerror = reject
        link.onload = link.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          link.onload = link.onreadystatechange = null
          resolve()
        }
        document.head.appendChild(link)
      })
    
      win.activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#18171d')
        }
      }
      win.activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#f7f9fe')
        }
      }
      const t = saveToLocal.get('theme')
    
          const isDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches
          const isLightMode = window.matchMedia('(prefers-color-scheme: light)').matches
          const isNotSpecified = window.matchMedia('(prefers-color-scheme: no-preference)').matches
          const hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified

          if (t === undefined) {
            if (isLightMode) activateLightMode()
            else if (isDarkMode) activateDarkMode()
            else if (isNotSpecified || hasNoSupport) {
              const now = new Date()
              const hour = now.getHours()
              const isNight = hour <= 6 || hour >= 18
              isNight ? activateDarkMode() : activateLightMode()
            }
            window.matchMedia('(prefers-color-scheme: dark)').addListener(e => {
              if (saveToLocal.get('theme') === undefined) {
                e.matches ? activateDarkMode() : activateLightMode()
              }
            })
          } else if (t === 'light') activateLightMode()
          else activateDarkMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
      const detectApple = () => {
        if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
          document.documentElement.classList.add('apple')
        }
      }
      detectApple()
    })(window)</script><!-- hexo injector head_end start --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css" integrity="sha512-fHwaWebuwA7NSF5Qg/af4UeDx9XqUpYpOGgubo3yWu+b2IQR4UeQwbb42Ti7gVAjNtVoI/I9TEoYeu9omwcC6g==" crossorigin="anonymous" referrerpolicy="no-referrer" /><!-- hexo injector head_end end --><meta name="generator" content="Hexo 7.3.0"></head><body data-type="anzhiyu"><div id="web_bg"></div><div id="an_music_bg"></div><div id="loading-box" onclick="document.getElementById(&quot;loading-box&quot;).classList.add(&quot;loaded&quot;)"><div class="loading-bg"><img class="loading-img nolazyload" alt="加载头像" src="https://pic.arctanp.top/PicGo/avator"/><div class="loading-image-dot"></div></div></div><script>const preloader = {
  endLoading: () => {
    document.getElementById('loading-box').classList.add("loaded");
  },
  initLoading: () => {
    document.getElementById('loading-box').classList.remove("loaded")
  }
}
window.addEventListener('load',()=> { preloader.endLoading() })
setTimeout(function(){preloader.endLoading();},10000)

if (true) {
  document.addEventListener('pjax:send', () => { preloader.initLoading() })
  document.addEventListener('pjax:complete', () => { preloader.endLoading() })
}</script><link rel="stylesheet" href="https://cdn.cbd.int/anzhiyu-theme-static@1.1.10/progress_bar/progress_bar.css"/><script async="async" src="https://cdn.cbd.int/pace-js@1.2.4/pace.min.js" data-pace-options="{ &quot;restartOnRequestAfter&quot;:false,&quot;eventLag&quot;:false}"></script><div class="post" id="body-wrap"><header class="post-bg" id="page-header"><nav id="nav"><div id="nav-group"><span id="blog_name"><div class="back-home-button"><i class="anzhiyufont anzhiyu-icon-grip-vertical"></i><div class="back-menu-list-groups"><div class="back-menu-list-group"><div class="back-menu-list-title">网页</div><div class="back-menu-list"><a class="back-menu-item" href="https://blog.arctanp.top" title="博客"><img class="back-menu-item-icon" alt="博客"/><span class="back-menu-item-text">博客</span></a></div></div><div class="back-menu-list-group"><div class="back-menu-list-title">项目</div><div class="back-menu-list"><a class="back-menu-item" target="_blank" rel="noopener" href="https://pic.arctanp.top" title="图床"><img class="back-menu-item-icon" alt="图床"/><span class="back-menu-item-text">图床</span></a></div></div></div></div><a id="site-name" href="/" accesskey="h"><div class="title">arctanp</div><i class="anzhiyufont anzhiyu-icon-house-chimney"></i></a><div id="he-plugin-simple"></div><script>var WIDGET = {
  "CONFIG": {
    "modules": "0124",
    "background": "2",
    "tmpColor": "FFFFFF",
    "tmpSize": "16",
    "cityColor": "FFFFFF",
    "citySize": "16",
    "aqiColor": "E8D87B",
    "aqiSize": "16",
    "weatherIconSize": "24",
    "alertIconSize": "18",
    "padding": "10px 10px 10px 10px",
    "shadow": "0",
    "language": "auto",
    "borderRadius": "20",
    "fixed": "true",
    "vertical": "top",
    "horizontal": "left",
    "left": "20",
    "top": "7.1",
    "key": "df245676fb434a0691ead1c63341cd94"
  }
}
</script><link rel="stylesheet" href="https://widget.qweather.net/simple/static/css/he-simple.css?v=1.4.0"/><script src="https://widget.qweather.net/simple/static/js/he-simple.js?v=1.4.0"></script></span><div class="mask-name-container"><div id="name-container"><a id="page-name" href="javascript:anzhiyu.scrollToDest(0, 500)">PAGE_NAME</a></div></div><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page faa-parent animated-hover" target="_blank" rel="noopener" href="https://www.arctanp.top"><span> 主页</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 文章</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/archives/"><i class="anzhiyufont anzhiyu-icon-box-archive faa-tada" style="font-size: 0.9em;"></i><span> 隧道</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/categories/"><i class="anzhiyufont anzhiyu-icon-shapes faa-tada" style="font-size: 0.9em;"></i><span> 分类</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/tags/"><i class="anzhiyufont anzhiyu-icon-tags faa-tada" style="font-size: 0.9em;"></i><span> 标签</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 友链</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/link/"><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-link"></use></svg><span> 友人帐</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/comments/"><i class="anzhiyufont anzhiyu-icon-envelope faa-tada" style="font-size: 0.9em;"></i><span> 留言板</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 我的</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/music/?id=2024775299&amp;server=netease"><i class="anzhiyufont anzhiyu-icon-music faa-tada" style="font-size: 0.9em;"></i><span> 音乐馆</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/bangumis/"><i class="anzhiyufont anzhiyu-icon-bilibili faa-tada" style="font-size: 0.9em;"></i><span> 追番页</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 关于</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/essay/"><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-lightbulb"></use></svg><span> 闲言碎语</span></a></li></ul></div></div></div><div id="nav-right"><div class="nav-button only-home" id="travellings_button" title="随机前往一个开往项目网站"><a class="site-page" onclick="anzhiyu.totraveling()" title="随机前往一个开往项目网站" href="javascript:void(0);" rel="external nofollow" data-pjax-state="external"><i class="anzhiyufont anzhiyu-icon-train"></i></a></div><div class="nav-button" id="randomPost_button"><a class="site-page" onclick="toRandomPost()" title="随机前往一个文章" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-dice"></i></a></div><input id="center-console" type="checkbox"/><label class="widget" for="center-console" title="中控台" onclick="anzhiyu.switchConsole();"><i class="left"></i><i class="widget center"></i><i class="widget right"></i></label><div id="console"><div class="console-card-group-reward"><ul class="reward-all console-card"><li class="reward-item"><a href="https://npm.elemecdn.com/anzhiyu-blog@1.1.6/img/post/common/qrcode-weichat.png" target="_blank"><img class="post-qr-code-img" alt="微信" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;null&quot;" data-lazy-src="https://npm.elemecdn.com/anzhiyu-blog@1.1.6/img/post/common/qrcode-weichat.png"/></a><div class="post-qr-code-desc">微信</div></li><li class="reward-item"><a href="https://npm.elemecdn.com/anzhiyu-blog@1.1.6/img/post/common/qrcode-alipay.png" target="_blank"><img class="post-qr-code-img" alt="支付宝" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;null&quot;" data-lazy-src="https://npm.elemecdn.com/anzhiyu-blog@1.1.6/img/post/common/qrcode-alipay.png"/></a><div class="post-qr-code-desc">支付宝</div></li></ul></div><div class="console-card-group"><div class="console-card-group-left"><div class="console-card" id="card-newest-comments"><div class="card-content"><div class="author-content-item-tips">互动</div><span class="author-content-item-title"> 最新评论</span></div><div class="aside-list"><span>正在加载中...</span></div></div></div><div class="console-card-group-right"><div class="console-card tags"><div class="card-content"><div class="author-content-item-tips">兴趣点</div><span class="author-content-item-title">寻找你感兴趣的领域</span><div class="card-tags"><div class="item-headline"></div><div class="card-tag-cloud"><a href="/tags/C-C/" style="font-size: 1.05rem;">C/C++<sup>3</sup></a><a href="/tags/CSAPP/" style="font-size: 1.05rem;">CSAPP<sup>1</sup></a><a href="/tags/CTF/" style="font-size: 1.05rem;">CTF<sup>1</sup></a><a href="/tags/WriteUp/" style="font-size: 1.05rem;">WriteUp<sup>1</sup></a><a href="/tags/acm/" style="font-size: 1.05rem;">acm<sup>1</sup></a><a href="/tags/docker/" style="font-size: 1.05rem;">docker<sup>1</sup></a><a href="/tags/insights/" style="font-size: 1.05rem;">insights<sup>1</sup></a><a href="/tags/java/" style="font-size: 1.05rem;">java<sup>1</sup></a><a href="/tags/%E5%90%8E%E7%AB%AF/" style="font-size: 1.05rem;">后端<sup>1</sup></a><a href="/tags/%E5%A4%8D%E4%B9%A0%E7%AC%94%E8%AE%B0/" style="font-size: 1.05rem;">复习笔记<sup>2</sup></a><a href="/tags/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/" style="font-size: 1.05rem;">学习笔记<sup>2</sup></a><a href="/tags/%E6%95%B0%E5%AD%A6/" style="font-size: 1.05rem;">数学<sup>3</sup></a><a href="/tags/%E6%95%B0%E5%AD%A6%E5%88%86%E6%9E%90/" style="font-size: 1.05rem;">数学分析<sup>2</sup></a><a href="/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/" style="font-size: 1.05rem;">数据结构<sup>1</sup></a><a href="/tags/%E6%95%B0%E7%94%B5/" style="font-size: 1.05rem;">数电<sup>1</sup></a><a href="/tags/%E6%97%A5%E5%AF%84/" style="font-size: 1.05rem;">日寄<sup>3</sup></a><a href="/tags/%E7%89%A9%E7%90%86/" style="font-size: 1.05rem;">物理<sup>1</sup></a><a href="/tags/%E7%AE%97%E6%B3%95/" style="font-size: 1.05rem;">算法<sup>4</sup></a><a href="/tags/%E9%9A%8F%E7%AC%94/" style="font-size: 1.05rem;">随笔<sup>2</sup></a></div></div><hr/></div></div><div class="console-card history"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-box-archiv"></i><span>文章</span></div><div class="card-archives"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-archive"></i><span>归档</span><a class="card-more-btn" href="/archives/" title="查看更多">
    <i class="anzhiyufont anzhiyu-icon-angle-right"></i></a></div><ul class="card-archive-list"><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2025/10/"><span class="card-archive-list-date">十月 2025</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">1</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2025/09/"><span class="card-archive-list-date">九月 2025</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">2</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2025/08/"><span class="card-archive-list-date">八月 2025</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">1</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2025/06/"><span class="card-archive-list-date">六月 2025</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">2</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2025/05/"><span class="card-archive-list-date">五月 2025</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">2</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2025/04/"><span class="card-archive-list-date">四月 2025</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">2</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2025/03/"><span class="card-archive-list-date">三月 2025</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">5</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2025/02/"><span class="card-archive-list-date">二月 2025</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">1</span><span>篇</span></div></a></li></ul></div><hr/></div></div></div><div class="button-group"><div class="console-btn-item"><a class="darkmode_switchbutton" title="显示模式切换" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-moon"></i></a></div><div class="console-btn-item" id="consoleHideAside" onclick="anzhiyu.hideAsideBtn()" title="边栏显示控制"><a class="asideSwitch"><i class="anzhiyufont anzhiyu-icon-arrows-left-right"></i></a></div></div><div class="console-mask" onclick="anzhiyu.hideConsole()" href="javascript:void(0);"></div></div><div class="nav-button" id="nav-totop"><a class="totopbtn" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i><span id="percent" onclick="anzhiyu.scrollToDest(0,500)">0</span></a></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);" title="切换"><i class="anzhiyufont anzhiyu-icon-bars"></i></a></div></div></div></nav><div id="post-info"><div id="post-firstinfo"><div class="meta-firstline"><a class="post-meta-original">原创</a><span class="post-meta-categories"><span class="post-meta-separator"></span><i class="anzhiyufont anzhiyu-icon-inbox post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E5%BC%80%E5%8F%91/" itemprop="url">开发</a></span><span class="article-meta tags"><a class="article-meta__tags" href="/tags/docker/" tabindex="-1" itemprop="url"> <span> <i class="anzhiyufont anzhiyu-icon-hashtag"></i>docker</span></a><a class="article-meta__tags" href="/tags/%E5%90%8E%E7%AB%AF/" tabindex="-1" itemprop="url"> <span> <i class="anzhiyufont anzhiyu-icon-hashtag"></i>后端</span></a></span></div></div><h1 class="post-title" itemprop="name headline"> Docker Registry HTTP API V2 规范<a class="post-edit-link" href="undefined_posts/Docker Registry HTTP API V2 规范.md" title="在 GitHub 上编辑 -  Docker Registry HTTP API V2 规范" target="_blank"><i class="anzhiyufont anzhiyu-icon-pencil"></i></a></h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="anzhiyufont anzhiyu-icon-calendar-days post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" itemprop="dateCreated datePublished" datetime="2025-09-21T13:31:20.000Z" title="发表于 2025-09-21 21:31:20">2025-09-21</time><span class="post-meta-separator"></span><i class="anzhiyufont anzhiyu-icon-history post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" itemprop="dateCreated datePublished" datetime="2025-10-01T11:49:09.244Z" title="更新于 2025-10-01 19:49:09">2025-10-01</time></span></div><div class="meta-secondline"><span class="post-meta-separator"></span><span class="post-meta-wordcount"><i class="anzhiyufont anzhiyu-icon-file-word post-meta-icon" title="文章字数"></i><span class="post-meta-label" title="文章字数">字数总计:</span><span class="word-count" title="文章字数">2.7k</span><span class="post-meta-separator"></span><i class="anzhiyufont anzhiyu-icon-clock post-meta-icon" title="阅读时长"></i><span class="post-meta-label" title="阅读时长">阅读时长:</span><span>11分钟</span></span><span class="post-meta-separator"></span><span class="post-meta-pv-cv" id="" data-flag-title=" Docker Registry HTTP API V2 规范"><i class="anzhiyufont anzhiyu-icon-fw-eye post-meta-icon"></i><span class="post-meta-label" title="阅读量">阅读量:</span><span id="busuanzi_value_page_pv"><i class="anzhiyufont anzhiyu-icon-spinner anzhiyu-spin"></i></span></span><span class="post-meta-separator">       </span><span class="post-meta-position" title="作者IP属地为北京"><i class="anzhiyufont anzhiyu-icon-location-dot"></i>北京</span></div></div></div><section class="main-hero-waves-area waves-area"><svg class="waves-svg" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto"><defs><path id="gentle-wave" d="M -160 44 c 30 0 58 -18 88 -18 s 58 18 88 18 s 58 -18 88 -18 s 58 18 88 18 v 44 h -352 Z"></path></defs><g class="parallax"><use href="#gentle-wave" x="48" y="0"></use><use href="#gentle-wave" x="48" y="3"></use><use href="#gentle-wave" x="48" y="5"></use><use href="#gentle-wave" x="48" y="7"></use></g></svg></section><div id="post-top-cover"><img class="nolazyload" id="post-top-bg" src="https://pic.arctanp.top/PicGo/1742042046711.jpeg?_r_=d06eaa39-7233-2845-d544-02a9024b00df"></div></header><main id="blog-container"><div class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container" itemscope itemtype="http://blog.arctanp.top/2025/09/21/Docker%20Registry%20HTTP%20API%20V2%20%E8%A7%84%E8%8C%83/"><header><a class="post-meta-categories" href="/categories/%E5%BC%80%E5%8F%91/" itemprop="url">开发</a><a href="/tags/docker/" tabindex="-1" itemprop="url">docker</a><a href="/tags/%E5%90%8E%E7%AB%AF/" tabindex="-1" itemprop="url">后端</a><h1 id="CrawlerTitle" itemprop="name headline"> Docker Registry HTTP API V2 规范</h1><span itemprop="author" itemscope itemtype="http://schema.org/Person">Tanpinsary</span><time itemprop="dateCreated datePublished" datetime="2025-09-21T13:31:20.000Z" title="发表于 2025-09-21 21:31:20">2025-09-21</time><time itemprop="dateCreated datePublished" datetime="2025-10-01T11:49:09.244Z" title="更新于 2025-10-01 19:49:09">2025-10-01</time></header><p>整理一下 BYR2025 后端考核题 Docker It Yourself 需要的 Docker Registry API 规范文档内容，供项目编写使用。内容参考网站为 <a target="_blank" rel="noopener" href="https://docs.docker.com/reference/api/registry/latest/">Docker Registry HTTP API V2 规范</a></p>
<hr>
<h2 id="须知：">须知：</h2>
<ol>
<li>
<p>此 API 中的所有端点均以<strong>版本号</strong>和<strong>存储库名称</strong>作为前缀。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/v2/&lt;name&gt;</span><br></pre></td></tr></table></figure>
<p>例如，我想和 <code>library/ubuntu</code> 库进行交互，则使用：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/v2/library/ubuntu</span><br></pre></td></tr></table></figure>
</li>
<li>
<p>Autunentication 不做要求</p>
</li>
</ol>
<h2 id="Docker-Registry-构成">Docker Registry 构成</h2>
<p>Registry 一共要维护三类实体的信息：blob, manifest 和 manifest list.</p>
<p>Manifest 是描述镜像的 JSON 文档，包含其配置 blob、各每层 blob 的 digest，以及平台类型和注释等元数据。</p>
<p>Blob 是从 Manifest 文件中引用的二进制对象，包含 json config 和若干 tar 包。</p>
<p>Manifest list 是一个 Tag 所对应所有 Manifest 的元数据列表。获取 manifest list 后，通过对应的 digest 值获取 manifest, 再根据 manifest 的内容下载所有 Blob。</p>
<h2 id="Pulling-Images">Pulling Images</h2>
<p>拉取镜像，也就是检索 Manifest 并下载对应 Image 中的各层 Blob。以下为步骤：</p>
<ol>
<li>获取仓库 Tokens 鉴权（本次项目不需要实现）</li>
<li>获取 Image Manifest List</li>
<li>若前两步获取的是一个多架构的 Manifest List，则需要：
<ol>
<li>解析 Manifests[] 并根据架构定位具体 digest</li>
<li>根据 digest 获取 Image Manifest</li>
</ol>
</li>
<li>下载前确认 Blob 是否存在。客户端应该向每一层发送 <strong>HEAD</strong> 请求</li>
<li>根据前几步获取的 digest 从 manifest 中获取每一层的 Blob。客户端应发送 <strong>GET</strong> 请求</li>
</ol>
<p>下面是官网给的 Pulling Images 的脚本示例。示例拉取 linux/amd64 平台上 ubuntu:latest 镜像：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Step 1: Get a bearer token</span></span><br><span class="line">TOKEN=$(curl -s <span class="string">&quot;https://auth.docker.io/token?service=registry.docker.io&amp;scope=repository:library/ubuntu:pull&quot;</span> | jq -r .token)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Step 2: Get the image manifest. In this example, an image manifest list is returned.</span></span><br><span class="line">curl -s -H <span class="string">&quot;Authorization: Bearer <span class="variable">$TOKEN</span>&quot;</span> \</span><br><span class="line">     -H <span class="string">&quot;Accept: application/vnd.docker.distribution.manifest.list.v2+json&quot;</span> \</span><br><span class="line">     https://registry-1.docker.io/v2/library/ubuntu/manifests/latest \</span><br><span class="line">     -o manifest-list.json</span><br><span class="line"></span><br><span class="line"><span class="comment"># Step 3a: Parse the `manifests[]` array to locate the digest for your target platform (e.g., `linux/amd64`).</span></span><br><span class="line">IMAGE_MANIFEST_DIGEST=$(jq -r <span class="string">&#x27;.manifests[] | select(.platform.architecture == &quot;amd64&quot; and .platform.os == &quot;linux&quot;) | .digest&#x27;</span> manifest-list.json)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Step 3b: Get the platform-specific image manifest</span></span><br><span class="line">curl -s -H <span class="string">&quot;Authorization: Bearer <span class="variable">$TOKEN</span>&quot;</span> \</span><br><span class="line">     -H <span class="string">&quot;Accept: application/vnd.docker.distribution.manifest.v2+json&quot;</span> \</span><br><span class="line">     https://registry-1.docker.io/v2/library/ubuntu/manifests/<span class="variable">$IMAGE_MANIFEST_DIGEST</span> \</span><br><span class="line">     -o manifest.json</span><br><span class="line"></span><br><span class="line"><span class="comment"># Step 4: Send a HEAD request to check if the layer blob exists</span></span><br><span class="line">DIGEST=$(jq -r <span class="string">&#x27;.layers[0].digest&#x27;</span> manifest.json)</span><br><span class="line">curl -I -H <span class="string">&quot;Authorization: Bearer <span class="variable">$TOKEN</span>&quot;</span> \</span><br><span class="line">     https://registry-1.docker.io/v2/library/ubuntu/blobs/<span class="variable">$DIGEST</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Step 5: Download the layer blob</span></span><br><span class="line">curl -L -H <span class="string">&quot;Authorization: Bearer <span class="variable">$TOKEN</span>&quot;</span> \</span><br><span class="line">     https://registry-1.docker.io/v2/library/ubuntu/blobs/<span class="variable">$DIGEST</span></span><br></pre></td></tr></table></figure>
<h2 id="Pushing-Images">Pushing Images</h2>
<p>推送镜像，与拉取相对应的提交镜像的各层 blob（例如 config 和 layers），然后上传引用这些 blob 的 manifest。以下为步骤：</p>
<ol>
<li>
<p>获取仓库 Tokens 鉴权（本次项目不需要实现）</p>
</li>
<li>
<p>使用 HEAD 请求确保对于每一个 blob digest，对应的 blob 都存在</p>
</li>
<li>
<p>若不存在，则使用单体 PUT 请求上传 blob</p>
<ol>
<li>使用 POST 初始化上传</li>
<li>使用 PUT 完成上传</li>
</ol>
<blockquote>
<p>[!NOTE]</p>
<p>也可以使用分块上传的方式上传一个大型对象或者恢复终端上传。具体操作是使用 PATCH 请求发送每一个数据块，最后用 PUT 请求完成上传。</p>
</blockquote>
</li>
<li>
<p>使用 PUT 请求上传 Image Manifest 以关联 config 和 layers</p>
</li>
</ol>
<p>下面是官网给的 Pushing Images 的脚本示例。示例推送了一个空的 blob 和 manifest 到 Docker Hub 上。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"></span><br><span class="line">USERNAME=yourusername</span><br><span class="line">PASSWORD=dckr_pat</span><br><span class="line">REPO=yourusername/helloworld</span><br><span class="line">TAG=latest</span><br><span class="line">CONFIG=config.json</span><br><span class="line">MIME_TYPE=application/vnd.docker.container.image.v1+json</span><br><span class="line"></span><br><span class="line"><span class="comment"># Step 1: Get a bearer token</span></span><br><span class="line">TOKEN=$(curl -s -u <span class="string">&quot;<span class="variable">$USERNAME</span>:<span class="variable">$PASSWORD</span>&quot;</span> \</span><br><span class="line"><span class="string">&quot;https://auth.docker.io/token?service=registry.docker.io&amp;scope=repository:<span class="variable">$REPO</span>:push,pull&quot;</span> \</span><br><span class="line">| jq -r .token)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Create a dummy config blob and compute its digest</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&#x27;&#123;&quot;architecture&quot;:&quot;amd64&quot;,&quot;os&quot;:&quot;linux&quot;,&quot;config&quot;:&#123;&#125;,&quot;rootfs&quot;:&#123;&quot;type&quot;:&quot;layers&quot;,&quot;diff_ids&quot;:[]&#125;&#125;&#x27;</span> &gt; <span class="variable">$CONFIG</span></span><br><span class="line">DIGEST=<span class="string">&quot;sha256:<span class="subst">$(sha256sum $CONFIG | awk &#x27;&#123;print $1&#125;&#x27;)</span>&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Step 2: Check if the blob exists</span></span><br><span class="line">STATUS=$(curl -s -o /dev/null -w <span class="string">&quot;%&#123;http_code&#125;&quot;</span> -I \</span><br><span class="line">  -H <span class="string">&quot;Authorization: Bearer <span class="variable">$TOKEN</span>&quot;</span> \</span><br><span class="line">  https://registry-1.docker.io/v2/<span class="variable">$REPO</span>/blobs/<span class="variable">$DIGEST</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> [ <span class="string">&quot;<span class="variable">$STATUS</span>&quot;</span> != <span class="string">&quot;200&quot;</span> ]; <span class="keyword">then</span></span><br><span class="line">  <span class="comment"># Step 3: Upload blob using monolithic upload</span></span><br><span class="line">  LOCATION=$(curl -sI -X POST \</span><br><span class="line">    -H <span class="string">&quot;Authorization: Bearer <span class="variable">$TOKEN</span>&quot;</span> \</span><br><span class="line">    https://registry-1.docker.io/v2/<span class="variable">$REPO</span>/blobs/uploads/ \</span><br><span class="line">    | grep -i Location | <span class="built_in">tr</span> -d <span class="string">&#x27;\r&#x27;</span> | awk <span class="string">&#x27;&#123;print $2&#125;&#x27;</span>)</span><br><span class="line"></span><br><span class="line">  curl -s -X PUT <span class="string">&quot;<span class="variable">$LOCATION</span>&amp;digest=<span class="variable">$DIGEST</span>&quot;</span> \</span><br><span class="line">    -H <span class="string">&quot;Authorization: Bearer <span class="variable">$TOKEN</span>&quot;</span> \</span><br><span class="line">    -H <span class="string">&quot;Content-Type: application/octet-stream&quot;</span> \</span><br><span class="line">    --data-binary @<span class="variable">$CONFIG</span></span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Step 4: Upload the manifest that references the config blob</span></span><br><span class="line">MANIFEST=$(<span class="built_in">cat</span> &lt;&lt;<span class="string">EOF</span></span><br><span class="line"><span class="string">&#123;</span></span><br><span class="line"><span class="string">  &quot;schemaVersion&quot;: 2,</span></span><br><span class="line"><span class="string">  &quot;mediaType&quot;: &quot;application/vnd.docker.distribution.manifest.v2+json&quot;,</span></span><br><span class="line"><span class="string">  &quot;config&quot;: &#123;</span></span><br><span class="line"><span class="string">    &quot;mediaType&quot;: &quot;$MIME_TYPE&quot;,</span></span><br><span class="line"><span class="string">    &quot;size&quot;: $(stat -c%s $CONFIG),</span></span><br><span class="line"><span class="string">    &quot;digest&quot;: &quot;$DIGEST&quot;</span></span><br><span class="line"><span class="string">  &#125;,</span></span><br><span class="line"><span class="string">  &quot;layers&quot;: []</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string">EOF</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">curl -s -X PUT \</span><br><span class="line">  -H <span class="string">&quot;Authorization: Bearer <span class="variable">$TOKEN</span>&quot;</span> \</span><br><span class="line">  -H <span class="string">&quot;Content-Type: application/vnd.docker.distribution.manifest.v2+json&quot;</span> \</span><br><span class="line">  -d <span class="string">&quot;<span class="variable">$MANIFEST</span>&quot;</span> \</span><br><span class="line">  https://registry-1.docker.io/v2/<span class="variable">$REPO</span>/manifests/<span class="variable">$TAG</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;Pushed image to <span class="variable">$REPO</span>:<span class="variable">$TAG</span>&quot;</span></span><br></pre></td></tr></table></figure>
<p>该样例推送了一个不包含任何 layers 的镜像。如果要推送一个完整的有内容的镜像，需要对每个 layer 重复 2-3 次的推送并且把每个 layer 的 digest 保存在 manifest 的 layers[] 内。</p>
<h2 id="Deleting-Images">Deleting Images</h2>
<p>删除镜像，包括通过 digest 删除 manifest。想要删除首先得获取 manifest digest，然后再使用 DELETE 请求删除 digest。</p>
<p>并非所有的 manifest 都可以删除。只有没有 tag 标记的 manifest 或者没有被其他 tag 或者 images 引用的 manifest 才能被删除（我猜是避免空指针问题）。如果删除的 manifest 是被引用的，返回 <code>403 Forbidden</code>。以下为步骤：</p>
<ol>
<li>获取仓库 Tokens 鉴权（本项目不需要实现）</li>
<li>使用 Images Tag 获取 manifest</li>
<li>从清单响应中获取 Docker-Content-Digest 标头。该摘要可唯一标识该清单</li>
<li>使用 DELETE 请求，根据 digest 删除 manifest</li>
</ol>
<p>下面是官网给的 Deleting Images 的脚本示例。示例删除了 Docker Hub 上 yourusername/helloworld 的 latest，不过似乎没有检查是否该 image 被其他 tag 引用。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"></span><br><span class="line">USERNAME=yourusername</span><br><span class="line">PASSWORD=dckr_pat</span><br><span class="line">REPO=yourusername/helloworld</span><br><span class="line">TAG=latest</span><br><span class="line"></span><br><span class="line"><span class="comment"># Step 1: Get a bearer token</span></span><br><span class="line">TOKEN=$(curl -s -u <span class="string">&quot;<span class="variable">$USERNAME</span>:<span class="variable">$PASSWORD</span>&quot;</span> \</span><br><span class="line">  <span class="string">&quot;https://auth.docker.io/token?service=registry.docker.io&amp;scope=repository:<span class="variable">$REPO</span>:pull,push,delete&quot;</span> \</span><br><span class="line">  | jq -r .token)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Step 2 and 3: Get the manifest and extract the digest from response headers</span></span><br><span class="line">DIGEST=$(curl -sI -H <span class="string">&quot;Authorization: Bearer <span class="variable">$TOKEN</span>&quot;</span> \</span><br><span class="line">  -H <span class="string">&quot;Accept: application/vnd.docker.distribution.manifest.v2+json&quot;</span> \</span><br><span class="line">  https://registry-1.docker.io/v2/<span class="variable">$REPO</span>/manifests/<span class="variable">$TAG</span> \</span><br><span class="line">  | grep -i Docker-Content-Digest | <span class="built_in">tr</span> -d <span class="string">&#x27;\r&#x27;</span> | awk <span class="string">&#x27;&#123;print $2&#125;&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;Deleting manifest with digest: <span class="variable">$DIGEST</span>&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Step 4: Delete the manifest by digest</span></span><br><span class="line">curl -s -X DELETE \</span><br><span class="line">  -H <span class="string">&quot;Authorization: Bearer <span class="variable">$TOKEN</span>&quot;</span> \</span><br><span class="line">  https://registry-1.docker.io/v2/<span class="variable">$REPO</span>/manifests/<span class="variable">$DIGEST</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;Deleted image: <span class="variable">$REPO</span>@<span class="variable">$DIGEST</span>&quot;</span></span><br></pre></td></tr></table></figure>
<h2 id="API">API</h2>
<h3 id="API-列表和响应码（省流版）">API 列表和响应码（省流版）</h3>
<h4 id="Manifest">Manifest</h4>
<h5 id="Get-image-manifest">Get image manifest</h5>
<ul>
<li>200 Manifest fetched successfully.</li>
<li>400 Invalid name or reference.</li>
<li>404 Respository or manifest not found.</li>
</ul>
<h5 id="Put-image-manifest">Put image manifest</h5>
<ul>
<li>201 Manifest created successfully.</li>
<li>400 Invalid name, reference, or manifest.</li>
<li>404 Respository not found.</li>
</ul>
<h5 id="Check-if-manifest-exists">Check if manifest exists</h5>
<ul>
<li>200 Manifest exists.</li>
<li>404 Manifest not found.</li>
</ul>
<h5 id="Delete-image-manifest">Delete image manifest</h5>
<ul>
<li>202 Manifest deleted successfully. No content returned.</li>
<li>404 Manifest or respository not found.</li>
</ul>
<h4 id="Blob">Blob</h4>
<h5 id="Initiate-blob-upload-or-attempt-cross-repository-blob-mount">Initiate blob upload or attempt cross-repository blob mount</h5>
<ul>
<li>201 Blob successfully mounted from another repository.</li>
<li>202 Upload initiated successfully (fallback if mount fails).</li>
<li>404 Repository not found.</li>
</ul>
<h5 id="Check-existence-of-blob">Check existence of blob</h5>
<ul>
<li>200 Blob exists.</li>
<li>404 Blob not found.</li>
</ul>
<h5 id="Retrieve-blob">Retrieve blob</h5>
<ul>
<li>200 Blob content returned directly.</li>
<li>404 Blob not found.</li>
</ul>
<h5 id="Get-blob-upload-status">Get blob upload status</h5>
<ul>
<li>204 Upload in progress. No body returned.</li>
<li>404 Upload session not found.</li>
</ul>
<h5 id="Complete-blob-upload">Complete blob upload</h5>
<ul>
<li>201 Upliad completed successfully.</li>
<li>400 Invalid digest or missing parameters</li>
<li>404 Upload session not found.</li>
</ul>
<h5 id="Upload-blob-chunk">Upload blob chunk</h5>
<ul>
<li>202 Chunk accepted and stored.</li>
<li>400 Malformed content or range.</li>
<li>404 Upload session not found.</li>
</ul>
<h5 id="Cancel-blob-upload">Cancel blob upload</h5>
<ul>
<li>204 Upload session cancelled successfully. No body is returned.</li>
<li>404 Upload session not found.</li>
</ul>
<h3 id="API-详细参数相应格式">API 详细参数相应格式</h3>
<h4 id="Manifest-2">Manifest</h4>
<ul>
<li>
<p>GET image manifest
由 name 和 reference 获取 manifest，其中 reference 可以是 tag 也可以是 digest
获取一个标准的 Manifest 格式</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">GET /V2/&#123;name&#125;/manifests/&#123;reference&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>
<p>Request:<img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;null&quot;" data-lazy-src="https://pic.arctanp.top/PicGo/10d1d408-3d35-43e7-a855-e65376b84928.png" alt=""></p>
</li>
<li>
<p>Responses:
<img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;null&quot;" data-lazy-src="https://pic.arctanp.top/PicGo/20251001194824.png" alt=""></p>
</li>
</ul>
</li>
<li>
<p>PUT image manifest
上传指定 tag 或者 digest 的 manifest 到 registry。
Manifest 的 media type 为 <code>application/vnd.docker.distribution.manifest.v2+json</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">PUT /v2/&#123;name&#125;/manifests/&#123;reference&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>
<p>Request:<img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;null&quot;" data-lazy-src="https://pic.arctanp.top/PicGo/20250923153715.png" alt=""></p>
</li>
<li>
<p>Response:
<img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;null&quot;" data-lazy-src="https://pic.arctanp.top/PicGo/20250923153803.png" alt=""></p>
</li>
</ul>
</li>
<li>
<p>Check if manifest exists
通过 tag 或 digest 验证 manifest 是否存在。</p>
<p>仅返回头信息（无正文）。适用于：</p>
<ul>
<li>检查特定镜像版本是否存在</li>
<li>在下载或删除前确定清单的摘要或大小
此接口需要具有拉取权限的身份验证。</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">HEAD /v2/&#123;name&#125;/manifests/&#123;reference&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>
<p>Requests:
<img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;null&quot;" data-lazy-src="https://pic.arctanp.top/PicGo/20250923154038.png" alt=""></p>
</li>
<li>
<p>Response:
<img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;null&quot;" data-lazy-src="https://pic.arctanp.top/PicGo/20251001194750.png" alt=""></p>
</li>
</ul>
</li>
<li>
<p>Delete image manifest
通过摘要从存储库中删除映像清单，仅可删除未标记或未被引用的清单。若清单仍被标签或其他映像引用，注册表将返回403禁止访问状态码。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">DELETE /v2/&#123;name&#125;/manifests/&#123;reference&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>
<p>Request:
<img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;null&quot;" data-lazy-src="https://pic.arctanp.top/PicGo/20250923154332.png" alt=""></p>
</li>
<li>
<p>Response:<img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;null&quot;" data-lazy-src="https://pic.arctanp.top/PicGo/20250923154411.png" alt=""></p>
</li>
</ul>
</li>
</ul>
<h4 id="Blob-2">Blob</h4>
<ul>
<li>
<p>Initiate blob upload or attempt cross-repository blob mount</p>
<p>为存储库中的 blob（layer 或 config）启动上传会话。这是上传 blob 的第一步。该操作返回一个位置URL，用户可通过 PATCH（分块上传）或 PUT（整体上传）方式将块对象上传至该位置。</p>
<p>客户端也可尝试挂载其他存储库中的 blob（需具备读取权限），通过添加 mount 和 from 查询参数实现。</p>
<p>若挂载成功，注册表将返回 201 Created 状态码，blob 将被复用而无需重新上传。</p>
<p>若挂载失败，上传将按常规流程进行并返回 202 Accepted 状态码。</p>
<p>必须使用具有目标存储库推送权限的凭据进行身份验证。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">POST /v2/&#123;name&#125;/blobs/uploads/</span><br></pre></td></tr></table></figure>
<ul>
<li>
<p>Request:
<img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;null&quot;" data-lazy-src="https://pic.arctanp.top/PicGo/20250923155044.png" alt=""></p>
</li>
<li>
<p>Response:
<img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;null&quot;" data-lazy-src="https://pic.arctanp.top/PicGo/20250923155121.png" alt=""></p>
</li>
</ul>
</li>
<li>
<p>Check existence of blob</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">HEAD /v2/&#123;name&#125;/blobs/&#123;digest&#125;</span><br></pre></td></tr></table></figure>
<p>检查 blob 是否已经存在</p>
<ul>
<li>
<p>Request:</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;null&quot;" data-lazy-src="https://pic.arctanp.top/PicGo/20250923155456.png" alt=""></p>
</li>
<li>
<p>Response:
<img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;null&quot;" data-lazy-src="https://pic.arctanp.top/PicGo/20251001194850.png" alt=""></p>
</li>
</ul>
</li>
<li>
<p>Retrieve blob</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">GET /v2/&#123;name&#125;/blobs/&#123;digest&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>Request:
<img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;null&quot;" data-lazy-src="https://pic.arctanp.top/PicGo/20250923160743.png" alt=""></li>
<li>Responses:
<img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;null&quot;" data-lazy-src="https://pic.arctanp.top/PicGo/20250923160728.png" alt=""></li>
</ul>
</li>
<li>
<p>Get blob upload status</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">GET /v2/&#123;name&#125;/blobs/uploads/&#123;uuid&#125;</span><br></pre></td></tr></table></figure>
<p>检索正在进行的 blob 上传的当前状态。</p>
<p>此功能适用于：恢复中断的上传；确定当前已接收的字节数；在分块上传中从正确偏移量重试；响应包含 Range 标头（指示当前接收的字节范围）和用于识别会话的 Docker-Upload-UUID。</p>
<ul>
<li>
<p>Request:</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;null&quot;" data-lazy-src="https://pic.arctanp.top/PicGo/20250923161104.png" alt=""></p>
</li>
<li>
<p>Responses:
<img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;null&quot;" data-lazy-src="https://pic.arctanp.top/PicGo/20250923162739.png" alt=""></p>
</li>
</ul>
</li>
<li>
<p>Complete blob upload</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">PUT /v2/&#123;name&#125;/blobs/uploads/&#123;uuid&#125;</span><br></pre></td></tr></table></figure>
<p>此请求必须包含摘要查询参数，并可选地包含最后一个数据块。当存储注册表收到此请求时，它会验证摘要并存储 blob。</p>
<p>此端点支持：整体上传（在此请求中上传整个 blob）或完成分块上传（最后一个数据块加摘要）</p>
<ul>
<li>Request:
<img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;null&quot;" data-lazy-src="https://pic.arctanp.top/PicGo/20250923162651.png" alt=""></li>
<li>Responses:
<img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;null&quot;" data-lazy-src="https://pic.arctanp.top/PicGo/20250923162721.png" alt=""></li>
</ul>
</li>
<li>
<p>Upload blob chunk</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">PATCH /v2/&#123;name&#125;/blobs/uploads/&#123;uuid&#125;</span><br></pre></td></tr></table></figure>
<p>将块状数据分段上传至活跃的上传会话。</p>
<p>此方法适用于分段上传，尤其适用于大型块状数据或恢复中断上传的情境。</p>
<p>客户端通过PATCH请求发送二进制数据，可选添加Content-Range头部。</p>
<p>每当分块被接受后，注册表将返回202 Accepted响应，包含：</p>
<p>Range：当前存储的字节范围
Docker-Upload-UUID：上传会话标识符
Location：继续上传或通过PUT完成上传的URL</p>
<ul>
<li>Request:
<img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;null&quot;" data-lazy-src="https://pic.arctanp.top/PicGo/20250923165640.png" alt=""></li>
<li>Response:
<img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;null&quot;" data-lazy-src="https://pic.arctanp.top/PicGo/20250923165722.png" alt=""></li>
</ul>
</li>
<li>
<p>Cancel blob upload</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">DELETE /v2/&#123;name&#125;/blobs/uploads/&#123;uuid&#125;</span><br></pre></td></tr></table></figure>
<p>取消正在进行的 blob 上传会话。</p>
<p>此操作将丢弃已上传的所有数据并使上传会话失效。</p>
<p>适用场景：</p>
<p>上传失败或中途中止时
客户端需要清理未使用的上传会话时
取消后，UUID 将失效，必须重新发出 POST 请求才能重启上传。</p>
<ul>
<li>Request:
<img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;null&quot;" data-lazy-src="https://pic.arctanp.top/PicGo/20250923170532.png" alt=""></li>
<li>Response:
<img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;null&quot;" data-lazy-src="https://pic.arctanp.top/PicGo/20250923170551.png" alt=""></li>
</ul>
</li>
</ul>
</article><div class="post-copyright"><div class="copyright-cc-box"><i class="anzhiyufont anzhiyu-icon-copyright"></i></div><div class="post-copyright__author_box"><a class="post-copyright__author_img" href="/" title="头像"><img class="post-copyright__author_img_back" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;null&quot;" data-lazy-src="https://pic.arctanp.top/PicGo/avator" title="头像" alt="头像"><img class="post-copyright__author_img_front" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;null&quot;" data-lazy-src="https://pic.arctanp.top/PicGo/avator" title="头像" alt="头像"></a><div class="post-copyright__author_name">Tanpinsary</div><div class="post-copyright__author_desc">tanps blog</div></div><div class="post-copyright__post__info"><a class="post-copyright__original" title="该文章为原创文章，注意版权协议" href="http://blog.arctanp.top/2025/09/21/Docker%20Registry%20HTTP%20API%20V2%20%E8%A7%84%E8%8C%83/">原创</a><a class="post-copyright-title"><span onclick="rm.copyPageUrl('http://blog.arctanp.top/2025/09/21/Docker Registry HTTP API V2 规范/')"> Docker Registry HTTP API V2 规范</span></a></div><div class="post-tools" id="post-tools"><div class="post-tools-left"><div class="rewardLeftButton"></div><div class="shareRight"><div class="share-link mobile"><div class="share-qrcode"><div class="share-button" title="使用手机访问这篇文章"><i class="anzhiyufont anzhiyu-icon-qrcode"></i></div><div class="share-main"><div class="share-main-all"><div id="qrcode" title="http://blog.arctanp.top/2025/09/21/Docker%20Registry%20HTTP%20API%20V2%20%E8%A7%84%E8%8C%83/"></div><div class="reward-dec">使用手机访问这篇文章</div></div></div></div></div><div class="share-link weibo"><a class="share-button" target="_blank" href="https://service.weibo.com/share/share.php?title= Docker Registry HTTP API V2 规范&amp;url=http://blog.arctanp.top/2025/09/21/Docker%20Registry%20HTTP%20API%20V2%20%E8%A7%84%E8%8C%83/&amp;pic=https://pic.arctanp.top/PicGo/1742042046711.jpeg?_r_=d06eaa39-7233-2845-d544-02a9024b00df" rel="external nofollow noreferrer noopener"><i class="anzhiyufont anzhiyu-icon-weibo"></i></a></div><script>function copyCurrentPageUrl() {
  var currentPageUrl = window.location.href;
  var input = document.createElement("input");
  input.setAttribute("value", currentPageUrl);
  document.body.appendChild(input);
  input.select();
  input.setSelectionRange(0, 99999);
  document.execCommand("copy");
  document.body.removeChild(input);
}</script><div class="share-link copyurl"><div class="share-button" id="post-share-url" title="复制链接" onclick="copyCurrentPageUrl()"><i class="anzhiyufont anzhiyu-icon-link"></i></div></div></div></div></div><div class="post-copyright__notice"><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="http://blog.arctanp.top" target="_blank">arctanp</a>！</span></div></div><div class="post-tools-right"><div class="tag_share"><div class="post-meta__box"><div class="post-meta__box__tag-list"><a class="post-meta__box__tags" href="/tags/docker/"><span class="tags-punctuation"> <i class="anzhiyufont anzhiyu-icon-tag"></i></span>docker<span class="tagsPageCount">1</span></a><a class="post-meta__box__tags" href="/tags/%E5%90%8E%E7%AB%AF/"><span class="tags-punctuation"> <i class="anzhiyufont anzhiyu-icon-tag"></i></span>后端<span class="tagsPageCount">1</span></a></div></div></div><div class="post_share"><div class="social-share" data-image="https://pic.arctanp.top/PicGo/1742042046711.jpeg?_r_=d06eaa39-7233-2845-d544-02a9024b00df" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.cbd.int/butterfly-extsrc@1.1.3/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"/><script src="https://cdn.cbd.int/butterfly-extsrc@1.1.3/sharejs/dist/js/social-share.min.js" defer="defer"></script></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="card-content"><div class="author-info__sayhi" id="author-info__sayhi" onclick="anzhiyu.changeSayHelloText()"></div><div class="author-info-avatar"><img class="avatar-img" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;null&quot;" data-lazy-src="https://pic.arctanp.top/PicGo/avator" onerror="this.onerror=null;this.src='/null'" alt="avatar"/><div class="author-status"><img class="g-status" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;null&quot;" data-lazy-src="https://emotion.acs.pw/emotion/QQ/101.gif" alt="status"/></div></div><div class="author-info__description">摸了</div><div class="author-info__bottom-group"><a class="author-info__bottom-group-left" href="/about"><h1 class="author-info__name">Tanpinsary</h1><div class="author-info__desc">tanps blog</div></a><div class="card-info-social-icons is-center"><a class="social-icon faa-parent animated-hover" href="https://github.com/Tanpinsary" target="_blank" title="Github"><i class="anzhiyufont anzhiyu-icon-github"></i></a><a class="social-icon faa-parent animated-hover" href="https://space.bilibili.com/391553043" target="_blank" title="BiliBili"><i class="anzhiyufont anzhiyu-icon-bilibili"></i></a></div></div></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-bullhorn anzhiyu-shake"></i><span>公告</span></div><div class="announcement_content">blog建设ing 半成品</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-bars"></i><span>文章目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%A1%BB%E7%9F%A5%EF%BC%9A"><span class="toc-number">1.</span> <span class="toc-text">须知：</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Docker-Registry-%E6%9E%84%E6%88%90"><span class="toc-number">2.</span> <span class="toc-text">Docker Registry 构成</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Pulling-Images"><span class="toc-number">3.</span> <span class="toc-text">Pulling Images</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Pushing-Images"><span class="toc-number">4.</span> <span class="toc-text">Pushing Images</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Deleting-Images"><span class="toc-number">5.</span> <span class="toc-text">Deleting Images</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#API"><span class="toc-number">6.</span> <span class="toc-text">API</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#API-%E5%88%97%E8%A1%A8%E5%92%8C%E5%93%8D%E5%BA%94%E7%A0%81%EF%BC%88%E7%9C%81%E6%B5%81%E7%89%88%EF%BC%89"><span class="toc-number">6.1.</span> <span class="toc-text">API 列表和响应码（省流版）</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Manifest"><span class="toc-number">6.1.1.</span> <span class="toc-text">Manifest</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#Get-image-manifest"><span class="toc-number">6.1.1.1.</span> <span class="toc-text">Get image manifest</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#Put-image-manifest"><span class="toc-number">6.1.1.2.</span> <span class="toc-text">Put image manifest</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#Check-if-manifest-exists"><span class="toc-number">6.1.1.3.</span> <span class="toc-text">Check if manifest exists</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#Delete-image-manifest"><span class="toc-number">6.1.1.4.</span> <span class="toc-text">Delete image manifest</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Blob"><span class="toc-number">6.1.2.</span> <span class="toc-text">Blob</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#Initiate-blob-upload-or-attempt-cross-repository-blob-mount"><span class="toc-number">6.1.2.1.</span> <span class="toc-text">Initiate blob upload or attempt cross-repository blob mount</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#Check-existence-of-blob"><span class="toc-number">6.1.2.2.</span> <span class="toc-text">Check existence of blob</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#Retrieve-blob"><span class="toc-number">6.1.2.3.</span> <span class="toc-text">Retrieve blob</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#Get-blob-upload-status"><span class="toc-number">6.1.2.4.</span> <span class="toc-text">Get blob upload status</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#Complete-blob-upload"><span class="toc-number">6.1.2.5.</span> <span class="toc-text">Complete blob upload</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#Upload-blob-chunk"><span class="toc-number">6.1.2.6.</span> <span class="toc-text">Upload blob chunk</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#Cancel-blob-upload"><span class="toc-number">6.1.2.7.</span> <span class="toc-text">Cancel blob upload</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#API-%E8%AF%A6%E7%BB%86%E5%8F%82%E6%95%B0%E7%9B%B8%E5%BA%94%E6%A0%BC%E5%BC%8F"><span class="toc-number">6.2.</span> <span class="toc-text">API 详细参数相应格式</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Manifest-2"><span class="toc-number">6.2.1.</span> <span class="toc-text">Manifest</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Blob-2"><span class="toc-number">6.2.2.</span> <span class="toc-text">Blob</span></a></li></ol></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-history"></i><span>最近发布</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2025/10/12/TSCTF-J2025%20WriteUp/" title="TSCTF-J2025-WriteUp"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;null&quot;" data-lazy-src="https://pic.arctanp.top/PicGo/1742042046711.jpeg?_r_=911bbfa9-9d8c-7083-7c6a-9c2fe95c539e" onerror="this.onerror=null;this.src='/null'" alt="TSCTF-J2025-WriteUp"/></a><div class="content"><a class="title" href="/2025/10/12/TSCTF-J2025%20WriteUp/" title="TSCTF-J2025-WriteUp">TSCTF-J2025-WriteUp</a><time datetime="2025-10-12T14:45:48.000Z" title="发表于 2025-10-12 22:45:48">2025-10-12</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/09/21/Docker%20Registry%20HTTP%20API%20V2%20%E8%A7%84%E8%8C%83/" title=" Docker Registry HTTP API V2 规范"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;null&quot;" data-lazy-src="https://pic.arctanp.top/PicGo/1742042046711.jpeg?_r_=d06eaa39-7233-2845-d544-02a9024b00df" onerror="this.onerror=null;this.src='/null'" alt=" Docker Registry HTTP API V2 规范"/></a><div class="content"><a class="title" href="/2025/09/21/Docker%20Registry%20HTTP%20API%20V2%20%E8%A7%84%E8%8C%83/" title=" Docker Registry HTTP API V2 规范"> Docker Registry HTTP API V2 规范</a><time datetime="2025-09-21T13:31:20.000Z" title="发表于 2025-09-21 21:31:20">2025-09-21</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/09/12/CS61B-sp21%20Project0/" title="CS61B-sp21 Project0"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;null&quot;" data-lazy-src="https://pic.arctanp.top/PicGo/87f4053febb8101cae0bcfa88d9338ca9a834e1b_raw.jpg?_r_=8bc2badf-b45e-efa8-435c-172474a483ed" onerror="this.onerror=null;this.src='/null'" alt="CS61B-sp21 Project0"/></a><div class="content"><a class="title" href="/2025/09/12/CS61B-sp21%20Project0/" title="CS61B-sp21 Project0">CS61B-sp21 Project0</a><time datetime="2025-09-12T04:59:23.000Z" title="发表于 2025-09-12 12:59:23">2025-09-12</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/08/06/Leetcode%20Hot100/" title="Leetcode Hot100"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;null&quot;" data-lazy-src="https://pic.arctanp.top/PicGo/1742042046711.jpeg?_r_=64d99420-b72a-de9f-a3c1-d551412827af" onerror="this.onerror=null;this.src='/null'" alt="Leetcode Hot100"/></a><div class="content"><a class="title" href="/2025/08/06/Leetcode%20Hot100/" title="Leetcode Hot100">Leetcode Hot100</a><time datetime="2025-08-06T14:59:24.000Z" title="发表于 2025-08-06 22:59:24">2025-08-06</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/06/22/%E5%B8%B8%E6%B7%B7%E6%B7%86%E5%9B%9B%E7%A7%8D%E7%BB%84%E5%90%88%E9%80%BB%E8%BE%91%E5%8A%9F%E8%83%BD%E5%99%A8%E4%BB%B6%E8%BE%A8%E6%9E%90/" title="常混淆四种组合逻辑功能器件辨析"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;null&quot;" data-lazy-src="https://pic.arctanp.top/PicGo/be8d1b40503276b0ac033894ad5bbd93.jpg?_r_=8044c9a7-9940-8203-8b43-0314c6e01c32" onerror="this.onerror=null;this.src='/null'" alt="常混淆四种组合逻辑功能器件辨析"/></a><div class="content"><a class="title" href="/2025/06/22/%E5%B8%B8%E6%B7%B7%E6%B7%86%E5%9B%9B%E7%A7%8D%E7%BB%84%E5%90%88%E9%80%BB%E8%BE%91%E5%8A%9F%E8%83%BD%E5%99%A8%E4%BB%B6%E8%BE%A8%E6%9E%90/" title="常混淆四种组合逻辑功能器件辨析">常混淆四种组合逻辑功能器件辨析</a><time datetime="2025-06-22T09:02:30.000Z" title="发表于 2025-06-22 17:02:30">2025-06-22</time></div></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div id="workboard"><div id="runtimeTextTip"></div></div></div><div id="footer-bar"><div class="footer-bar-links"><div class="footer-bar-left"><div id="footer-bar-tips"><div class="copyright">&copy;2025 By <a class="footer-bar-link" href="/" title="Tanpinsary" target="_blank">Tanpinsary</a></div></div><div id="footer-type-tips"></div></div><div class="footer-bar-right"><a class="footer-bar-link" target="_blank" rel="noopener" href="https://github.com/anzhiyu-c/hexo-theme-anzhiyu" title="主题">主题</a><a class="footer-bar-link" target="_blank" rel="noopener" href="https://pic.arctanp.top" title="图床">图床</a></div></div></div></footer></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="sidebar-site-data site-data is-center"><a href="/archives/" title="archive"><div class="headline">文章</div><div class="length-num">21</div></a><a href="/tags/" title="tag"><div class="headline">标签</div><div class="length-num">19</div></a><a href="/categories/" title="category"><div class="headline">分类</div><div class="length-num">14</div></a></div><span class="sidebar-menu-item-title">功能</span><div class="sidebar-menu-item"><a class="darkmode_switchbutton menu-child" href="javascript:void(0);" title="显示模式"><i class="anzhiyufont anzhiyu-icon-circle-half-stroke"></i><span>显示模式</span></a></div><div class="back-menu-list-groups"><div class="back-menu-list-group"><div class="back-menu-list-title">网页</div><div class="back-menu-list"><a class="back-menu-item" href="https://blog.arctanp.top" title="博客"><img class="back-menu-item-icon" alt="博客"/><span class="back-menu-item-text">博客</span></a></div></div><div class="back-menu-list-group"><div class="back-menu-list-title">项目</div><div class="back-menu-list"><a class="back-menu-item" target="_blank" rel="noopener" href="https://pic.arctanp.top" title="图床"><img class="back-menu-item-icon" alt="图床"/><span class="back-menu-item-text">图床</span></a></div></div></div><div class="menus_items"><div class="menus_item"><a class="site-page faa-parent animated-hover" target="_blank" rel="noopener" href="https://www.arctanp.top"><span> 主页</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 文章</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/archives/"><i class="anzhiyufont anzhiyu-icon-box-archive faa-tada" style="font-size: 0.9em;"></i><span> 隧道</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/categories/"><i class="anzhiyufont anzhiyu-icon-shapes faa-tada" style="font-size: 0.9em;"></i><span> 分类</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/tags/"><i class="anzhiyufont anzhiyu-icon-tags faa-tada" style="font-size: 0.9em;"></i><span> 标签</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 友链</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/link/"><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-link"></use></svg><span> 友人帐</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/comments/"><i class="anzhiyufont anzhiyu-icon-envelope faa-tada" style="font-size: 0.9em;"></i><span> 留言板</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 我的</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/music/?id=2024775299&amp;server=netease"><i class="anzhiyufont anzhiyu-icon-music faa-tada" style="font-size: 0.9em;"></i><span> 音乐馆</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/bangumis/"><i class="anzhiyufont anzhiyu-icon-bilibili faa-tada" style="font-size: 0.9em;"></i><span> 追番页</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 关于</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/essay/"><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-lightbulb"></use></svg><span> 闲言碎语</span></a></li></ul></div></div><span class="sidebar-menu-item-title">标签</span><div class="card-tags"><div class="item-headline"></div><div class="card-tag-cloud"><a href="/tags/C-C/" style="font-size: 0.88rem;">C/C++<sup>3</sup></a><a href="/tags/CSAPP/" style="font-size: 0.88rem;">CSAPP<sup>1</sup></a><a href="/tags/CTF/" style="font-size: 0.88rem;">CTF<sup>1</sup></a><a href="/tags/WriteUp/" style="font-size: 0.88rem;">WriteUp<sup>1</sup></a><a href="/tags/acm/" style="font-size: 0.88rem;">acm<sup>1</sup></a><a href="/tags/docker/" style="font-size: 0.88rem;">docker<sup>1</sup></a><a href="/tags/insights/" style="font-size: 0.88rem;">insights<sup>1</sup></a><a href="/tags/java/" style="font-size: 0.88rem;">java<sup>1</sup></a><a href="/tags/%E5%90%8E%E7%AB%AF/" style="font-size: 0.88rem;">后端<sup>1</sup></a><a href="/tags/%E5%A4%8D%E4%B9%A0%E7%AC%94%E8%AE%B0/" style="font-size: 0.88rem;">复习笔记<sup>2</sup></a><a href="/tags/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/" style="font-size: 0.88rem;">学习笔记<sup>2</sup></a><a href="/tags/%E6%95%B0%E5%AD%A6/" style="font-size: 0.88rem;">数学<sup>3</sup></a><a href="/tags/%E6%95%B0%E5%AD%A6%E5%88%86%E6%9E%90/" style="font-size: 0.88rem;">数学分析<sup>2</sup></a><a href="/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/" style="font-size: 0.88rem;">数据结构<sup>1</sup></a><a href="/tags/%E6%95%B0%E7%94%B5/" style="font-size: 0.88rem;">数电<sup>1</sup></a><a href="/tags/%E6%97%A5%E5%AF%84/" style="font-size: 0.88rem;">日寄<sup>3</sup></a><a href="/tags/%E7%89%A9%E7%90%86/" style="font-size: 0.88rem;">物理<sup>1</sup></a><a href="/tags/%E7%AE%97%E6%B3%95/" style="font-size: 0.88rem;">算法<sup>4</sup></a><a href="/tags/%E9%9A%8F%E7%AC%94/" style="font-size: 0.88rem;">随笔<sup>2</sup></a></div></div><hr/></div></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="anzhiyufont anzhiyu-icon-book-open"></i></button><button id="translateLink" type="button" title="简繁转换">繁</button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="anzhiyufont anzhiyu-icon-circle-half-stroke"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="anzhiyufont anzhiyu-icon-arrows-left-right"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="anzhiyufont anzhiyu-icon-gear"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="anzhiyufont anzhiyu-icon-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i></button></div></div><div id="rightMenu"><div class="rightMenu-group rightMenu-small"><div class="rightMenu-item" id="menu-backward"><i class="anzhiyufont anzhiyu-icon-arrow-left"></i></div><div class="rightMenu-item" id="menu-forward"><i class="anzhiyufont anzhiyu-icon-arrow-right"></i></div><div class="rightMenu-item" id="menu-refresh"><i class="anzhiyufont anzhiyu-icon-arrow-rotate-right" style="font-size: 1rem;"></i></div><div class="rightMenu-item" id="menu-top"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i></div></div><div class="rightMenu-group rightMenu-line rightMenuPlugin"><div class="rightMenu-item" id="menu-copytext"><i class="anzhiyufont anzhiyu-icon-copy"></i><span>复制选中文本</span></div><div class="rightMenu-item" id="menu-pastetext"><i class="anzhiyufont anzhiyu-icon-paste"></i><span>粘贴文本</span></div><a class="rightMenu-item" id="menu-commenttext"><i class="anzhiyufont anzhiyu-icon-comment-medical"></i><span>引用到评论</span></a><div class="rightMenu-item" id="menu-newwindow"><i class="anzhiyufont anzhiyu-icon-window-restore"></i><span>新窗口打开</span></div><div class="rightMenu-item" id="menu-copylink"><i class="anzhiyufont anzhiyu-icon-link"></i><span>复制链接地址</span></div><div class="rightMenu-item" id="menu-copyimg"><i class="anzhiyufont anzhiyu-icon-images"></i><span>复制此图片</span></div><div class="rightMenu-item" id="menu-downloadimg"><i class="anzhiyufont anzhiyu-icon-download"></i><span>下载此图片</span></div><div class="rightMenu-item" id="menu-newwindowimg"><i class="anzhiyufont anzhiyu-icon-window-restore"></i><span>新窗口打开图片</span></div><div class="rightMenu-item" id="menu-search"><i class="anzhiyufont anzhiyu-icon-magnifying-glass"></i><span>站内搜索</span></div><div class="rightMenu-item" id="menu-searchBaidu"><i class="anzhiyufont anzhiyu-icon-magnifying-glass"></i><span>百度搜索</span></div><div class="rightMenu-item" id="menu-music-toggle"><i class="anzhiyufont anzhiyu-icon-play"></i><span>播放音乐</span></div><div class="rightMenu-item" id="menu-music-back"><i class="anzhiyufont anzhiyu-icon-backward"></i><span>切换到上一首</span></div><div class="rightMenu-item" id="menu-music-forward"><i class="anzhiyufont anzhiyu-icon-forward"></i><span>切换到下一首</span></div><div class="rightMenu-item" id="menu-music-playlist" onclick="window.open(&quot;https://music.163.com/#/playlist?id=2024775299&quot;, &quot;_blank&quot;);" style="display: none;"><i class="anzhiyufont anzhiyu-icon-radio"></i><span>查看所有歌曲</span></div><div class="rightMenu-item" id="menu-music-copyMusicName"><i class="anzhiyufont anzhiyu-icon-copy"></i><span>复制歌名</span></div></div><div class="rightMenu-group rightMenu-line rightMenuOther"><a class="rightMenu-item menu-link" id="menu-randomPost"><i class="anzhiyufont anzhiyu-icon-shuffle"></i><span>随便逛逛</span></a><a class="rightMenu-item menu-link" href="/categories/"><i class="anzhiyufont anzhiyu-icon-cube"></i><span>博客分类</span></a><a class="rightMenu-item menu-link" href="/tags/"><i class="anzhiyufont anzhiyu-icon-tags"></i><span>文章标签</span></a></div><div class="rightMenu-group rightMenu-line rightMenuOther"><a class="rightMenu-item" id="menu-copy" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-copy"></i><span>复制地址</span></a><a class="rightMenu-item" id="menu-commentBarrage" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-message"></i><span class="menu-commentBarrage-text">关闭热评</span></a><a class="rightMenu-item" id="menu-darkmode" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-circle-half-stroke"></i><span class="menu-darkmode-text">深色模式</span></a><a class="rightMenu-item" id="menu-translate" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-language"></i><span>轉為繁體</span></a></div></div><div id="rightmenu-mask"></div><div id="he-plugin-simple"></div><script>var WIDGET = {
  "CONFIG": {
    "modules": "0124",
    "background": "2",
    "tmpColor": "FFFFFF",
    "tmpSize": "16",
    "cityColor": "FFFFFF",
    "citySize": "16",
    "aqiColor": "E8D87B",
    "aqiSize": "16",
    "weatherIconSize": "24",
    "alertIconSize": "18",
    "padding": "10px 10px 10px 10px",
    "shadow": "0",
    "language": "auto",
    "borderRadius": "20",
    "fixed": "true",
    "vertical": "top",
    "horizontal": "left",
    "left": "20",
    "top": "7.1",
    "key": "df245676fb434a0691ead1c63341cd94"
  }
}
</script><link rel="stylesheet" href="https://widget.qweather.net/simple/static/css/he-simple.css?v=1.4.0"/><script src="https://widget.qweather.net/simple/static/js/he-simple.js?v=1.4.0"></script><div><script src="https://cdn.cbd.int/hexo-theme-anzhiyu@1.6.14/source/js/utils.js"></script><script src="https://cdn.cbd.int/hexo-theme-anzhiyu@1.6.14/source/js/main.js"></script><script src="https://cdn.cbd.int/hexo-theme-anzhiyu@1.6.14/source/js/tw_cn.js"></script><script src="https://cdn.cbd.int/@fancyapps/ui@5.0.28/dist/fancybox/fancybox.umd.js"></script><script src="https://cdn.cbd.int/instant.page@5.2.0/instantpage.js" type="module"></script><script src="https://cdn.cbd.int/vanilla-lazyload@17.8.5/dist/lazyload.iife.min.js"></script><script src="https://cdn.cbd.int/node-snackbar@0.1.16/dist/snackbar.min.js"></script><canvas id="universe"></canvas><script async src="https://npm.elemecdn.com/anzhiyu-theme-static@1.0.0/dark/dark.js"></script><script>// 消除控制台打印
var HoldLog = console.log;
console.log = function () {};
let now1 = new Date();
queueMicrotask(() => {
  const Log = function () {
    HoldLog.apply(console, arguments);
  }; //在恢复前输出日志
  const grt = new Date("01/13/2025 00:00:00"); //此处修改你的建站时间或者网站上线时间
  now1.setTime(now1.getTime() + 250);
  const days = (now1 - grt) / 1000 / 60 / 60 / 24;
  const dnum = Math.floor(days);
  const ascll = [
    `欢迎使用安知鱼!`,
    `生活明朗, 万物可爱`,
    `
        
       █████╗ ███╗   ██╗███████╗██╗  ██╗██╗██╗   ██╗██╗   ██╗
      ██╔══██╗████╗  ██║╚══███╔╝██║  ██║██║╚██╗ ██╔╝██║   ██║
      ███████║██╔██╗ ██║  ███╔╝ ███████║██║ ╚████╔╝ ██║   ██║
      ██╔══██║██║╚██╗██║ ███╔╝  ██╔══██║██║  ╚██╔╝  ██║   ██║
      ██║  ██║██║ ╚████║███████╗██║  ██║██║   ██║   ╚██████╔╝
      ╚═╝  ╚═╝╚═╝  ╚═══╝╚══════╝╚═╝  ╚═╝╚═╝   ╚═╝    ╚═════╝
        
        `,
    "已上线",
    dnum,
    "天",
    "©2025 By 安知鱼 V1.6.14",
  ];
  const ascll2 = [`NCC2-036`, `调用前置摄像头拍照成功，识别为【小笨蛋】.`, `Photo captured: `, `🤪`];

  setTimeout(
    Log.bind(
      console,
      `\n%c${ascll[0]} %c ${ascll[1]} %c ${ascll[2]} %c${ascll[3]}%c ${ascll[4]}%c ${ascll[5]}\n\n%c ${ascll[6]}\n`,
      "color:#425AEF",
      "",
      "color:#425AEF",
      "color:#425AEF",
      "",
      "color:#425AEF",
      ""
    )
  );
  setTimeout(
    Log.bind(
      console,
      `%c ${ascll2[0]} %c ${ascll2[1]} %c \n${ascll2[2]} %c\n${ascll2[3]}\n`,
      "color:white; background-color:#4fd953",
      "",
      "",
      'background:url("https://npm.elemecdn.com/anzhiyu-blog@1.1.6/img/post/common/tinggge.gif") no-repeat;font-size:450%'
    )
  );

  setTimeout(Log.bind(console, "%c WELCOME %c 你好，小笨蛋.", "color:white; background-color:#4f90d9", ""));

  setTimeout(
    console.warn.bind(
      console,
      "%c ⚡ Powered by 安知鱼 %c 你正在访问 Tanpinsary 的博客.",
      "color:white; background-color:#f0ad4e",
      ""
    )
  );

  setTimeout(Log.bind(console, "%c W23-12 %c 你已打开控制台.", "color:white; background-color:#4f90d9", ""));

  setTimeout(
    console.warn.bind(console, "%c S013-782 %c 你现在正处于监控中.", "color:white; background-color:#d9534f", "")
  );
});</script><script async src="/anzhiyu/random.js"></script><script async="async">(function () {
  var grt = new Date("01/13/2025 00:00:00"); //设置网站上线时间
  var now = new Date();
  var dnum;
  var hnum;
  var mnum;
  var snum;
  var nowHour;

  // 计算并更新天数、小时数、分钟数和秒数
  function updateTime() {
    now = new Date(); // 更新 now 的值
    nowHour = now.getHours(); // 更新 nowHour 的值
    var days = (now - grt) / 1000 / 60 / 60 / 24;
    dnum = Math.floor(days);
    var hours = (now - grt) / 1000 / 60 / 60 - 24 * dnum;
    hnum = Math.floor(hours);
    if (String(hnum).length == 1) {
      hnum = "0" + hnum;
    }
    var minutes = (now - grt) / 1000 / 60 - 24 * 60 * dnum - 60 * hnum;
    mnum = Math.floor(minutes);
    if (String(mnum).length == 1) {
      mnum = "0" + mnum;
    }
    var seconds = (now - grt) / 1000 - 24 * 60 * 60 * dnum - 60 * 60 * hnum - 60 * mnum;
    snum = Math.round(seconds);
    if (String(snum).length == 1) {
      snum = "0" + snum;
    }
  }

  // 更新网页中显示的网站运行时间
  function updateHtml() {
    const footer = document.getElementById("footer");
    if (!footer) return
    let currentTimeHtml = "";
    if (nowHour < 18 && nowHour >= 9) {
      // 如果是上班时间，默认就是"安知鱼-上班摸鱼中.svg"图片，不需要更改
      currentTimeHtml = `本站居然运行了 ${dnum} 天<span id='runtime'> ${hnum} 小时 ${mnum} 分 ${snum} 秒 </span><i class='anzhiyufont anzhiyu-icon-heartbeat' style='color:red'></i>`;
    } else {
      // 如果是下班时间，插入"安知鱼-下班啦.svg"图片
      let img = document.querySelector("#workboard .workSituationImg");
      if (img != null) {
        img.src = "";
        img.title = "摸了";
        img.alt = "摸了";
      }

      currentTimeHtml = `本站居然运行了 ${dnum} 天<span id='runtime'> ${hnum} 小时 ${mnum} 分 ${snum} 秒 </span><i class='anzhiyufont anzhiyu-icon-heartbeat' style='color:red'></i>`;
    }

    if (document.getElementById("runtimeTextTip")) {
      document.getElementById("runtimeTextTip").innerHTML = currentTimeHtml;
    }
  }

  setInterval(() => {
    updateTime();
    updateHtml();
  }, 1000);
})();</script><div class="js-pjax"><script>if (!window.MathJax) {
  window.MathJax = {
    tex: {
      inlineMath: [['$', '$'], ['\\(', '\\)']],
      tags: 'ams'
    },
    chtml: {
      scale: 1.1
    },
    options: {
      renderActions: {
        findScript: [10, doc => {
          for (const node of document.querySelectorAll('script[type^="math/tex"]')) {
            const display = !!node.type.match(/; *mode=display/)
            const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display)
            const text = document.createTextNode('')
            node.parentNode.replaceChild(text, node)
            math.start = {node: text, delim: '', n: 0}
            math.end = {node: text, delim: '', n: 0}
            doc.math.push(math)
          }
        }, '']
      }
    }
  }
  
  const script = document.createElement('script')
  script.src = 'https://cdn.cbd.int/mathjax@3.2.2/es5/tex-mml-chtml.js'
  script.id = 'MathJax-script'
  script.async = true
  document.head.appendChild(script)
} else {
  MathJax.startup.document.state(0)
  MathJax.texReset()
  MathJax.typesetPromise()
}</script><input type="hidden" name="page-type" id="page-type" value="post"></div><script>var visitorMail = "";
</script><script async data-pjax src="https://cdn.cbd.int/anzhiyu-theme-static@1.0.0/waterfall/waterfall.js"></script><script src="https://lf3-cdn-tos.bytecdntp.com/cdn/expire-1-M/qrcodejs/1.0.0/qrcode.min.js"></script><link rel="stylesheet" href="https://cdn.cbd.int/anzhiyu-theme-static@1.1.9/icon/ali_iconfont_css.css"><link rel="stylesheet" href="https://cdn.cbd.int/anzhiyu-theme-static@1.0.0/aplayer/APlayer.min.css" media="print" onload="this.media='all'"><script src="https://cdn.cbd.int/anzhiyu-blog-static@1.0.1/js/APlayer.min.js"></script><script src="https://cdn.cbd.int/hexo-anzhiyu-music@1.0.1/assets/js/Meting2.min.js"></script><script src="https://cdn.cbd.int/pjax@0.2.8/pjax.min.js"></script><script>let pjaxSelectors = ["head > title","#config-diff","#body-wrap","#rightside-config-hide","#rightside-config-show",".js-pjax"]
var pjax = new Pjax({
  elements: 'a:not([target="_blank"])',
  selectors: pjaxSelectors,
  cacheBust: false,
  analytics: false,
  scrollRestoration: false
})

document.addEventListener('pjax:send', function () {
  // removeEventListener scroll 
  anzhiyu.removeGlobalFnEvent('pjax')
  anzhiyu.removeGlobalFnEvent('themeChange')

  document.getElementById('rightside').classList.remove('rightside-show')
  
  if (window.aplayers) {
    for (let i = 0; i < window.aplayers.length; i++) {
      if (!window.aplayers[i].options.fixed) {
        window.aplayers[i].destroy()
      }
    }
  }

  typeof typed === 'object' && typed.destroy()

  //reset readmode
  const $bodyClassList = document.body.classList
  $bodyClassList.contains('read-mode') && $bodyClassList.remove('read-mode')
})

document.addEventListener('pjax:complete', function () {
  window.refreshFn()

  document.querySelectorAll('script[data-pjax]').forEach(item => {
    const newScript = document.createElement('script')
    const content = item.text || item.textContent || item.innerHTML || ""
    Array.from(item.attributes).forEach(attr => newScript.setAttribute(attr.name, attr.value))
    newScript.appendChild(document.createTextNode(content))
    item.parentNode.replaceChild(newScript, item)
  })

  GLOBAL_CONFIG.islazyload && window.lazyLoadInstance.update()

  typeof panguInit === 'function' && panguInit()

  // google analytics
  typeof gtag === 'function' && gtag('config', '', {'page_path': window.location.pathname});

  // baidu analytics
  typeof _hmt === 'object' && _hmt.push(['_trackPageview',window.location.pathname]);

  typeof loadMeting === 'function' && document.getElementsByClassName('aplayer').length && loadMeting()

  // prismjs
  typeof Prism === 'object' && Prism.highlightAll()
})

document.addEventListener('pjax:error', e => {
  if (e.request.status === 404) {
    pjax.loadUrl('/404.html')
  }
})</script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script charset="UTF-8" src="https://cdn.cbd.int/anzhiyu-theme-static@1.1.5/accesskey/accesskey.js"></script></div><div id="popup-window"><div class="popup-window-title">通知</div><div class="popup-window-divider"></div><div class="popup-window-content"><div class="popup-tip">你好呀</div><div class="popup-link"><i class="anzhiyufont anzhiyu-icon-arrow-circle-right"></i></div></div></div></body></html>